{"version":3,"sources":["types.js","components/EventDiv.js","App.js","index.js"],"names":["WEEKDAYS_SHORT","MONTHS","Date","date","setDate","getDate","get_date","EventDiv","props","Array","isArray","event","category","className","href","permalink","src","image","data-spai","alt","data-spai-upd","map","cat","key","name","title","short_description","App","React","useState","range","from","to","enteredTo","events","highlighted","state","setState","isSelectingFirstDay","day","isBeforeFirstDay","DateUtils","isDayBefore","handleResetClick","prevState","console","log","useEffect","searchParams","URLSearchParams","append","fetch","then","response","json","data","getPosts","disabledDays","before","selectedDays","Object","entries","v","modifiers","weekends","daysOfWeek","start","end","count","obj","ev","push","listEvents","numberOfMonths","firstDayOfWeek","fromMonth","onDayClick","setHours","onDayMouseEnter","months","weekdaysShort","onClick","rootElement","document","getElementById","ReactDOM","render"],"mappings":"mMAAaA,G,YAAiB,CAAC,eAAM,eAAM,eAAM,eAAM,eAAM,eAAM,iBACtDC,EAAS,CACpB,uCACA,6CACA,2BACA,uCACA,qBACA,2BACA,2BACA,uCACA,mDACA,6CACA,uCACA,8CAUe,IAAIC,KAPrB,WACE,IAAIC,EAAO,IAAID,KACfC,EAAKC,QAAQD,EAAKE,UAAY,GAMfC,GAFV,I,cCpBQ,SAASC,EAASC,GAO/B,OAAKC,MAAMC,QAAQF,EAAMG,MAAMC,UAG7B,sBAAKC,UAAU,mBAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,mBAAGC,KAAMN,EAAMG,MAAMI,UAArB,SACE,qBACEF,UAAU,cACVG,IAAKR,EAAMG,MAAMM,MACjBC,YAAU,IACVC,IAAI,GACJC,gBAAc,YAIpB,sBAAKP,UAAU,uDAAf,UACGL,EAAMG,MAAMC,SAASS,KAAI,SAACC,EAAKC,GAC9B,OACE,mBAEEV,UAAU,iBACVC,KAAK,4DAHP,SAKGQ,EAAIE,MAJAD,MAOP,IACJ,oBACET,KAAMN,EAAMG,MAAMI,UAClBF,UAAU,mCAFZ,UAIGL,EAAMG,MAAMc,MAAO,OAEtB,sBAAKZ,UAAU,oBAAf,UACGL,EAAMG,MAAMe,kBADf,WAGA,sBAAKb,UAAU,aAAf,UACE,cAAC,IAAD,IACA,uBAAMA,UAAU,aAAhB,UAA8BL,EAAMG,MAAMR,KAA1C,gBAtCyC,KC0KpCwB,MA5Kf,WACE,MAA0BC,IAAMC,SA4BvB,CACLC,MAAO,CAAEC,KAAM,KAAMC,GAAI,MACzBC,UAAW,KACXC,OAAQ,CAAEC,YAAa,MA/B3B,mBAAOC,EAAP,KAAcC,EAAd,KAkCA,SAASC,EAAoBP,EAAMC,EAAIO,GACrC,IAAMC,EAAmBT,GAAQU,YAAUC,YAAYH,EAAKR,GAI5D,OAAQA,GAAQS,GAHQT,GAAQC,EAqDlC,SAASW,IACPN,GAAS,SAACO,GAAD,mBAAC,eACLA,GADI,IAEPd,MAAO,CAAEC,KAAM,KAAMC,GAAI,WAE3Ba,QAAQC,IAAIV,GAxEdW,qBAAU,YApBV,WACE,IAAIC,EAAe,IAAIC,gBACvBD,EAAaE,OAAO,OAAQd,EAAMN,MAAMC,MACxCiB,EAAaE,OAAO,KAAMd,EAAMN,MAAME,IAEtCmB,MACE,mFACEH,GAEDI,MAAK,SAACC,GAAD,OAAcA,EAASC,UAC5BF,MAAK,SAACG,GACLV,QAAQC,IAAI,eAAgBS,GAE5BlB,GAAS,SAACO,GAAD,mBAAC,eACLA,GADI,IAEPV,OAAQqB,UAOdC,KACC,IAwEH,IAAQ1B,EAAqBM,EAArBN,MAAOG,EAAcG,EAAdH,UAETwB,EAAe,CAAEC,OAAQtB,EAAMN,MAAMC,MACrC4B,EAAe,CAAC7B,EAAMC,KAAM,CAAEA,KAAMD,EAAMC,KAAMC,GAAIC,IAEtDE,EAAcyB,OAAOC,QAAQzB,EAAMF,QAAQb,KAAI,WAASE,GAAS,IAAD,mBAAZuC,GAAY,WAClE,OAAO,IAAI5D,KAAK4D,EAAE3D,SAGd4D,EAAY,CAChBC,SAAU,CAAEC,WAAY,CAAC,EAAG,IAC5BC,MAAOpC,EAAMC,KACboC,IAAKrC,EAAME,GACXG,YAAaA,GAGXiC,EAAQ,EACRlC,EAAS,GACb0B,OAAOC,QAAQzB,EAAMF,QAAQb,KAAI,WAAWE,GAAS,IAAD,mBAAd8C,GAAc,WAC9CC,EAAK,IAAIpE,KAAKmE,EAAIlE,OAEnBmE,EAAKlC,EAAMN,MAAMC,MAAQuC,EAAKlC,EAAMN,MAAME,IACvB,MAApBI,EAAMN,MAAMC,QAEZG,EAAOqC,KAAKF,GACZD,QAGJ,IAAII,EAAatC,EAAOb,KAAI,SAACyC,EAAGvC,GAAJ,OAAY,cAAChB,EAAD,CAAoBI,MAAOmD,GAAZvC,MAEvD,OACE,gCACE,cAAC,IAAD,CACEV,UAAU,QACV4D,eAAgB,EAChBC,eAAgB,EAChBC,UAAW7C,EAAMC,KACjB4B,aAAcA,EACdF,aAAcA,EACdM,UAAWA,EACXa,WA/FN,SAAwBrC,GACtB,MAAqBH,EAAMN,MAAnBC,EAAR,EAAQA,KAAMC,EAAd,EAAcA,GACVD,EAAOC,GAIPD,GAAQC,GAAMO,GAAOR,GAAQQ,GAAOP,EAHtCW,IAOEL,EAAoBP,EAAMC,EAAIO,GAMhCF,GAAS,SAACO,GAAD,mBAAC,eACLA,GADI,IAEPd,MAAM,2BACDc,EAAUd,OADV,IAEHC,KAAM,IAAI7B,KAAKqC,EAAIsC,SAAS,MAE9B5C,UAAWM,OAIbF,GAAS,SAACO,GAAD,mBAAC,eACLA,GADI,IAEPd,MAAM,2BACDc,EAAUd,OADV,IAEHE,GAAI,IAAI9B,KAAKqC,EAAIsC,SAAS,GAAI,GAAI,OAEpC5C,UAAWM,QAgEXuC,gBA3DN,SAA6BvC,GAC3B,MAAqBH,EAAMN,MACtBQ,EADL,EAAQP,KAAR,EAAcC,GACqBO,IACjCF,GAAS,SAACO,GAAD,mBAAC,eACLA,GADI,IAEPX,UAAWM,QAuDXwC,OAAQ9E,EACR+E,cAAehF,IAEjB,8BAOG8B,EAAMC,MAAQD,EAAME,IACnB,wBAAQnB,UAAU,OAAOoE,QAAStC,EAAlC,gEAeJ,sBAAK9B,UAAU,UAAf,UAA0BuD,EAA1B,yEACA,qBAAKvD,UAAU,eAAf,SAA+B2D,QCzK/BU,EAAcC,SAASC,eAAe,QAC5CC,IAASC,OACP,cAAC,aAAD,UACE,cAAC,EAAD,MAEFJ,K","file":"static/js/main.d84a1fab.chunk.js","sourcesContent":["export const WEEKDAYS_SHORT = [\"Вс\", \"Пн\", \"Вт\", \"Ср\", \"Чт\", \"Пт\", \"Сб\"];\r\nexport const MONTHS = [\r\n  \"Январь\",\r\n  \"Февраль\",\r\n  \"Март\",\r\n  \"Апрель\",\r\n  \"Май\",\r\n  \"Июнь\",\r\n  \"Июль\",\r\n  \"Август\",\r\n  \"Сентябрь\",\r\n  \"Октябрь\",\r\n  \"Ноябрь\",\r\n  \"Декабрь\"\r\n];\r\n\r\nfunction get_date() {\r\n  let date = new Date();\r\n  date.setDate(date.getDate() + 4);\r\n  return date;\r\n}\r\n\r\nexport const EVENTS = [\r\n  { id: 1, date: new Date(), title: \"title1\", content: \"content1\" },\r\n  { id: 2, date: get_date(), title: \"title2\", content: \"content2\" }\r\n];\r\n","import { BsClock } from \"react-icons/bs\";\r\n\r\nexport default function EventDiv(props) {\r\n  /*\r\n  return(\r\n    <div> Event date: {props.ev.toLocaleString()}</div>\r\n  )\r\n*/\r\n\r\n  if (!Array.isArray(props.event.category)) return null;\r\n\r\n  return (\r\n    <div className=\"post post_medium\">\r\n      <div className=\"post__image-content\">\r\n        <a href={props.event.permalink}>\r\n          <img\r\n            className=\"post__image\"\r\n            src={props.event.image}\r\n            data-spai=\"1\"\r\n            alt=\"\"\r\n            data-spai-upd=\"374\"\r\n          />\r\n        </a>\r\n      </div>\r\n      <div className=\"post__content post__content_small post__content_high\">\r\n        {props.event.category.map((cat, key) => {\r\n          return (\r\n            <a\r\n              key={key}\r\n              className=\"link post__tag\"\r\n              href=\"https://russoft.org/our-events/?events-cat=russoft-events\"\r\n            >\r\n              {cat.name}\r\n            </a>\r\n          );\r\n        })}{\" \"}\r\n        <a\r\n          href={props.event.permalink}\r\n          className=\"link post__name post__name_small\"\r\n        >\r\n          {props.event.title}{\" \"}\r\n        </a>\r\n        <div className=\"post__description\">\r\n          {props.event.short_description}(\" \")\r\n        </div>\r\n        <div className=\"post__date\">\r\n          <BsClock />\r\n          <span className=\"post__time\">{props.event.date} </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import DayPicker, { DateUtils } from \"react-day-picker\";\nimport React, { useEffect } from \"react\";\nimport \"react-day-picker/lib/style.css\";\nimport \"./styles.css\";\nimport { WEEKDAYS_SHORT, MONTHS } from \"./types\";\nimport EventDiv from \"./components/EventDiv\";\n\nfunction App() {\n  const [state, setState] = React.useState(getInitialState());\n\n  function getPosts() {\n    var searchParams = new URLSearchParams();\n    searchParams.append(\"from\", state.range.from);\n    searchParams.append(\"to\", state.range.to);\n    //console.log(searchParams);\n    fetch(\n      \"https://russoft.org/wp-content/plugins/react-calendar/api.php?action=get_events&\" +\n        searchParams\n    )\n      .then((response) => response.json())\n      .then((data) => {\n        console.log(\"fetch data: \", data);\n\n        setState((prevState) => ({\n          ...prevState,\n          events: data\n        }));\n      });\n  }\n\n  useEffect(() => {\n    //console.log(\"did mount\", state);\n    getPosts();\n  }, []);\n\n  function getInitialState() {\n    return {\n      range: { from: null, to: null },\n      enteredTo: null,\n      events: { highlighted: [] }\n    };\n  }\n  function isSelectingFirstDay(from, to, day) {\n    const isBeforeFirstDay = from && DateUtils.isDayBefore(day, from);\n    const isRangeSelected = from && to;\n    //console.log(\"isBeforeFirstDay:\", isBeforeFirstDay);\n    //console.log(\"from:\", from);\n    return !from || isBeforeFirstDay || isRangeSelected;\n  }\n\n  function handleDayClick(day) {\n    const { from, to } = state.range;\n    if (from < to) {\n      handleResetClick();\n      return;\n    }\n    if (from && to && day >= from && day <= to) {\n      handleResetClick();\n      return;\n    }\n    if (isSelectingFirstDay(from, to, day)) {\n      // first click\n      //console.log(day);\n      //day = new Date(day.setHours(0));\n      //console.log(day);\n      //return;\n      setState((prevState) => ({\n        ...prevState,\n        range: {\n          ...prevState.range,\n          from: new Date(day.setHours(0))\n        },\n        enteredTo: day\n      }));\n    } else {\n      //console.log(\"second click\"); // second click\n      setState((prevState) => ({\n        ...prevState,\n        range: {\n          ...prevState.range,\n          to: new Date(day.setHours(23, 59, 59))\n        },\n        enteredTo: day\n      }));\n    }\n  }\n\n  function handleDayMouseEnter(day) {\n    const { from, to } = state.range;\n    if (!isSelectingFirstDay(from, to, day)) {\n      setState((prevState) => ({\n        ...prevState,\n        enteredTo: day\n      }));\n    }\n  }\n\n  function handleResetClick() {\n    setState((prevState) => ({\n      ...prevState,\n      range: { from: null, to: null }\n    }));\n    console.log(state);\n  }\n\n  const { range, enteredTo } = state;\n  //const modifiers = { start: range.from, end: enteredTo };\n  const disabledDays = { before: state.range.from };\n  const selectedDays = [range.from, { from: range.from, to: enteredTo }]; //o: enteredTo }];\n\n  let highlighted = Object.entries(state.events).map(([k, v], key) => {\n    return new Date(v.date);\n  });\n\n  const modifiers = {\n    weekends: { daysOfWeek: [6, 0] }, // saturday, sunday\n    start: range.from,\n    end: range.to,\n    highlighted: highlighted\n  };\n\n  let count = 0;\n  let events = [];\n  Object.entries(state.events).map(([k, obj], key) => {\n    let ev = new Date(obj.date);\n    if (\n      (ev > state.range.from && ev < state.range.to) ||\n      state.range.from == null\n    ) {\n      events.push(obj);\n      count++;\n    }\n  });\n  let listEvents = events.map((v, key) => <EventDiv key={key} event={v} />);\n\n  return (\n    <div>\n      <DayPicker\n        className=\"Range\"\n        numberOfMonths={2}\n        firstDayOfWeek={1}\n        fromMonth={range.from}\n        selectedDays={selectedDays}\n        disabledDays={disabledDays}\n        modifiers={modifiers}\n        onDayClick={handleDayClick}\n        onDayMouseEnter={handleDayMouseEnter}\n        months={MONTHS}\n        weekdaysShort={WEEKDAYS_SHORT}\n      />\n      <div>\n        {/* !range.from && !range.to && \"Please select the first day.\" */}\n        {/* range.from && !range.to && \"Please select the last day.\" */}\n        {/* range.from &&\n          range.to &&\n          `Selected from ${range.from.toLocaleDateString()} to\n        ${range.to.toLocaleDateString()}` */}\n        {range.from && range.to && (\n          <button className=\"link\" onClick={handleResetClick}>\n            Сбросить\n          </button>\n        )}\n      </div>\n      {/*\n      <p>\n        from: {state.range.from == null ? \"null\" : state.range.from.toString()}\n      </p>\n      <p>to: {state.range.to == null ? \"null\" : state.range.to.toString()}</p>\n      <p>\n        enteredTo:{\" \"}\n        {state.enteredTo == null ? \"null\" : state.enteredTo.toString()}\n      </p>\n      */}\n      <div className=\"counter\">{count} мероприятий</div>\n      <div className=\"row row-flex\">{listEvents}</div>\n    </div>\n  );\n}\n\nexport default App;\n","import { StrictMode } from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}